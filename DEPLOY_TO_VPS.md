# üöÄ –î–µ–ø–ª–æ–π Portfolio –Ω–∞ VPS nkolosov.com

–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è –≤–∞—à–µ–≥–æ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –Ω–∞ VPS —Å–µ—Ä–≤–µ—Ä.

## üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ

- **IP**: 79.174.78.124
- **–î–æ–º–µ–Ω**: nkolosov.com
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: root
- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞**: Ubuntu/Debian

## üéØ –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π (–≤—Å–µ –≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–µ)

```bash
# –ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π
make deploy-vps
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É VPS —Å–µ—Ä–≤–µ—Ä–∞
2. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É Docker –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
4. ‚úÖ –î–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
5. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫—É —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

## üìù –ü–æ—à–∞–≥–æ–≤—ã–π –¥–µ–ø–ª–æ–π

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å SSH –∫–ª—é—á
ls ~/.ssh/id_rsa* || ssh-keygen -t ed25519 -C "deploy@nkolosov.com"

# –î–æ–±–∞–≤—å—Ç–µ SSH –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω)
ssh-copy-id root@79.174.78.124
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ VPS —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –¢–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
make deploy-vps-setup
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç:

- Docker –∏ Docker Compose
- Nginx, PostgreSQL, Redis
- Firewall (UFW)
- Fail2ban –¥–ª—è –∑–∞—â–∏—Ç—ã
- Swap —Ñ–∞–π–ª
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 3. –î–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –¢–æ–ª—å–∫–æ –¥–µ–ø–ª–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make deploy-vps-app
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Let's Encrypt SSL
make deploy-vps-ssl
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
make check-vps
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü—Ä–∏ –¥–µ–ø–ª–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è `.env.production` —Ñ–∞–π–ª —Å:

- ‚úÖ –°–ª—É—á–∞–π–Ω—ã–º–∏ –ø–∞—Ä–æ–ª—è–º–∏ –¥–ª—è –ë–î
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–º NEXTAUTH_SECRET
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ URL –¥–ª—è –¥–æ–º–µ–Ω–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### –ß—Ç–æ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ `/home/portfolio/current/.env`:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@79.174.78.124

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ email
nano /home/portfolio/current/.env

# –ù–∞–π–¥–∏—Ç–µ –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
SMTP_USER=your-real-email@gmail.com
SMTP_PASS=your-app-password
```

## üîß –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@79.174.78.124
cd /home/portfolio/current
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
make status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make logs

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
make restart

# –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
make backup

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
make health
```

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å VPS
make check-vps

# –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
make deploy-vps-app

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —É–¥–∞–ª–µ–Ω–Ω–æ
ssh root@79.174.78.124 'cd /home/portfolio/current && make logs-app'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –í–∫–ª—é—á–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@79.174.78.124
cd /home/portfolio/current

# –ó–∞–ø—É—Å–∫ Prometheus + Grafana
make monitoring-start
```

–î–æ—Å—Ç—É–ø:

- **Grafana**: http://79.174.78.124:3001 (admin/admin)
- **Prometheus**: http://79.174.78.124:9090

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–¥–æ–º–µ–Ω–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–î–æ–±–∞–≤—å—Ç–µ A-–∑–∞–ø–∏—Å—å –≤ DNS:

- `monitoring.nkolosov.com` ‚Üí `79.174.78.124`

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

- ‚úÖ Firewall (—Ç–æ–ª—å–∫–æ 22, 80, 443 –ø–æ—Ä—Ç—ã)
- ‚úÖ Fail2ban –∑–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫
- ‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt
- ‚úÖ –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ Docker
- ‚úÖ Security headers –≤ Nginx

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å root**:

```bash
ssh root@79.174.78.124
passwd
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏** (–æ—Ç–∫–ª—é—á–∏—Ç–µ –ø–∞—Ä–æ–ª–∏):

```bash
# –í /etc/ssh/sshd_config
PasswordAuthentication no
systemctl restart ssh
```

3. **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:

```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab
0 4 * * 1 apt update && apt upgrade -y && docker system prune -f
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –õ–æ–∫–∞–ª—å–Ω–æ (–∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞)
git pull origin main
make deploy-vps-app
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
ssh root@79.174.78.124
apt update && apt upgrade -y
cd /home/portfolio/current
make restart
```

## üíæ –ë—ç–∫–∞–ø—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã

–ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –±—ç–∫–∞–ø—ã –≤ 2:00:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å cron
crontab -l

# –†—É—á–Ω–æ–π –±—ç–∫–∞–ø
cd /home/portfolio/current
make backup
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤
ls -la /var/backups/portfolio/

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
docker exec -i portfolio_postgres psql -U portfolio_user -d portfolio < /var/backups/portfolio/database/db_YYYYMMDD_HHMMSS.sql
```

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSL

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
ssh root@79.174.78.124
certbot certificates

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
certbot renew --force-renewal
docker restart portfolio_nginx
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
ssh root@79.174.78.124
cd /home/portfolio/current
make logs-app

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
make clean
make docker-build
make restart
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ë–î
make logs-db

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ë–î
docker-compose restart postgres

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
docker-compose exec app pnpm prisma db push
```

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üåê **–°–∞–π—Ç**: https://nkolosov.com
- üîß **–ê–¥–º–∏–Ω–∫–∞**: https://nkolosov.com/admin (–µ—Å–ª–∏ –µ—Å—Ç—å)
- üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: https://monitoring.nkolosov.com (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
ssh root@79.174.78.124
cd /home/portfolio/current
make info

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
df -h

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–º—è—Ç–∏
free -h

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
netstat -tlnp | grep :80
netstat -tlnp | grep :443
netstat -tlnp | grep :3000
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

- [ ] –°–∞–π—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ https://nkolosov.com
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–µ–ª–µ–Ω—ã–π –∑–∞–º–æ–∫)
- [ ] –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç email
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)

**–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ –í–∞—à–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ –Ω–∞ nkolosov.com**
